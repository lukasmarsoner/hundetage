image: cirrusci/flutter

before_script:
- flutter channel stable
- flutter packages get

stages:
- test
- coverage

UnitWidgetTests:
  stage: test
  script:
  - flutter test --coverage
  artifacts:
    paths:
    - coverage

coverage:
  image: ubuntu:16.04
  stage: coverage
  coverage: '/^\s+lines.+: (\d+.\d*%)/'
  dependencies:
  - UnitWidgetTests
  script:
  - genhtml -o coverage coverage/lcov.info
